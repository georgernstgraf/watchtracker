<!-- #timezone-selector.hbs -->
<div id="timeZoneEdit"
     x-data="{ editing: false, timeZone: '{{user.timeZone}}' }"
     class="d-inline-block">
    <!-- Default view: Button-like display -->
    <button x-show="!editing"
            @click="editing = true; $nextTick(() => document.getElementById('timeZoneSelector').focus())"
            class="btn btn-outline-secondary btn-sm px-2"
            title="Click to change timezone: {{user.timeZone}}"
            type="button">&nbsp;ğŸŒ&nbsp;&nbsp;&nbsp;{{user.timeZone}}
    </button>
    <!-- Edit mode: Input with datalist and controls -->
    <div x-show="editing"
         x-cloak
         @keydown.escape="editing = false"
         class="align-items-center gap-2">
        <form hx-patch="{{appPath}}/user"
              hx-target="#timeZoneEdit"
              hx-swap="outerHTML"
              hx-trigger="submit"
              @htmx:after-request="editing = false"
              class="d-flex align-items-center gap-2">
            <input id="timeZoneSelector"
                   list="timeZoneList"
                   name="timeZone"
                   :value="timeZone"
                   placeholder="Select timezone"
                   class="form-control form-control-sm"
                   style="width: 180px;"
                   autocomplete="off"
                   @keydown.escape="editing = false" />
            <datalist id="timeZoneList">
                {{#each timeZones}}
                    <option value="{{this}}">{{this}}</option>
                {{/each}}
            </datalist>
            <div class="btn-group btn-group-sm"
                 role="group">
                <button type="button"
                        class="btn btn-outline-secondary"
                        @click="editing = false"
                        title="Cancel"> âŒ </button>
                <button type="submit"
                        class="btn btn-outline-secondary"
                        title="Save timezone"> ğŸ’¾ </button>
            </div>
        </form>
    </div>
</div>
<!-- /timezone-selector.hbs -->